# Vertical Video Cropper - 智能垂直视频裁剪工具

## 🎬 项目简介

**Vertical Video Cropper** 是一个专业的智能视频裁剪工具，专门用于将横屏视频自动转换为9:16竖屏格式。通过先进的AI算法和智能裁剪技术，帮助内容创作者快速进行视频搬运、二次创作和自动剪辑。

> 💡 **自媒体全家桶用户群：1076150045** - 欢迎加入交流！

## ✨ 核心特性

### 🎯 智能裁剪算法
- **横屏转竖屏**：自动将16:9横屏视频转换为9:16竖屏格式
- **多种裁剪模式**：人脸检测、运动跟踪、中心裁剪
- **动态算法切换**：智能识别画面内容，自动选择最佳裁剪策略

### 🤖 智能识别技术
- **人脸检测**：实时检测视频中的人脸位置
- **运动跟踪**：使用光流算法跟踪画面运动焦点
- **智能优化**：自动调整裁剪参数以获得最佳效果

### 🎨 专业级输出
- **高质量保持**：保持原视频的清晰度和流畅度
- **格式兼容**：支持MP4、AVI、MOV等主流格式
- **尺寸优化**：自动适配各平台竖屏视频规格

## 🚀 主要用途

### 📱 视频搬运与二创
- **平台适配**：将YouTube横屏视频转换为TikTok/抖音竖屏格式
- **内容优化**：智能裁剪保留重要画面内容
- **批量处理**：支持多个视频文件的批量转换

### ✂️ 自动剪辑
- **智能裁切**：无需手动选择裁剪区域
- **效率提升**：一键完成视频格式转换
- **质量保证**：专业级的视频处理质量

### 🎥 内容创作
- **快速制作**：快速生成适合移动端的短视频
- **多场景适用**：访谈、教程、游戏录像等多种场景
- **自定义配置**：灵活的裁剪参数调整

## 🛠️ 技术特点

### 先进的裁剪算法
```python
# 动态人脸检测算法
class DynamicFaceCropper:
    def __init__(self):
        self.face_cascade = cv2.CascadeClassifier(...)
        self.tracking_enabled = True
    
    def process_frame(self, frame):
        # 实时人脸检测
        # 平滑位置跟踪
        # 智能边界处理
```

### 智能模式选择
- **人脸优先模式**：检测到人脸时优先使用人脸跟踪
- **运动跟踪模式**：无人物内容时使用运动焦点跟踪
- **中心裁剪模式**：简单内容的快速处理

### 性能优化
- **多线程处理**：后台处理不阻塞界面操作
- **内存优化**：大文件处理时的内存管理
- **错误恢复**：处理异常情况的容错机制

## 📊 功能对比

| 功能 | 人脸检测模式 | 运动跟踪模式 | 中心裁剪模式 |
|------|-------------|-------------|-------------|
| 处理速度 | 中等 | 中等 | 快速 |
| 智能程度 | 高 | 高 | 低 |
| 适用场景 | 人物视频 | 动态内容 | 简单内容 |
| 输出质量 | 优秀 | 良好 | 一般 |

## 🎨 界面设计

### GUI版本特色
- **现代化界面**：白色主题，清晰易用
- **直观操作**：拖拽式文件选择
- **实时预览**：处理进度和状态实时显示
- **参数调节**：可视化参数调整界面

### 界面布局
- **文件选择区**：输入输出文件选择
- **参数设置区**：裁剪模式和相关参数
- **进度显示区**：实时处理进度和状态
- **日志输出区**：详细的操作日志

## 🔧 安装使用

### 快速安装
```bash
# 下载项目
git clone <repository-url>
cd ver_vid_crop

# 安装依赖
pip install -r requirements.txt

# 运行GUI版本
python run_gui.py

# 或使用命令行版本
python vertical_video_cropper.py input.mp4 output.mp4 --mode face
```

### 系统要求
- **操作系统**：Windows 10+/Ubuntu 18.04+/macOS 10.15+
- **Python版本**：3.8+
- **内存**：4GB+（推荐8GB）
- **存储空间**：500MB+可用空间

### 依赖包
```
opencv-python >= 4.5.0
numpy >= 1.19.0
PySide6 >= 6.4.0 (GUI版本)
```

## 📖 使用教程

### 基础使用
1. **选择输入视频**：支持本地视频文件
2. **设置输出路径**：指定保存位置和文件名
3. **选择裁剪模式**：根据内容类型选择合适模式
4. **开始处理**：一键开始智能裁剪
5. **查看结果**：处理完成后预览效果

### 高级配置
```python
# 自定义配置示例
config = {
    'mode': 'face',  # 裁剪模式
    'face_detection': {
        'scale_factor': 1.1,      # 检测灵敏度
        'min_neighbors': 8,       # 最小邻居数
        'min_size': (30, 30),     # 最小人脸尺寸
        'right_offset': 60        # 右边界保护
    },
    'output': {
        'codec': 'mp4v',          # 输出编码
        'quality': 'high'         # 输出质量
    }
}
```

### 命令行使用
```bash
# 基本用法
python vertical_video_cropper.py input.mp4 output.mp4

# 指定裁剪模式
python vertical_video_cropper.py input.mp4 output.mp4 --mode motion

# 自定义参数
python vertical_video_cropper.py input.mp4 output.mp4 --mode face --scale-factor 1.2
```

## 🚀 TODO：GPU加速优化

### 当前功能
- ✅ OpenCV基础GPU支持
- ✅ 多线程视频处理
- ✅ 内存优化处理

### 计划优化
- 🔄 **CUDA加速**：利用GPU进行图像处理
- 🔄 **实时预览**：GPU加速的实时效果预览
- 🔄 **批量处理**：GPU并行处理多个视频
- 🔄 **性能监控**：实时显示GPU使用情况

### 性能目标
| 功能 | 当前性能 | 目标性能 | 提升幅度 |
|------|----------|----------|----------|
| 视频处理 | 1x | 3-5x | 200-400% |
| 人脸检测 | 1x | 5-8x | 400-700% |
| 运动跟踪 | 1x | 2-3x | 100-200% |

## 🐛 故障排除

### 常见问题

**1. 视频无法打开**
```bash
# 检查文件格式支持
ffmpeg -formats | grep mp4

# 检查文件权限
chmod +r input.mp4
```

**2. 人脸检测不准确**
- 调整`scale_factor`参数提高检测灵敏度
- 确保视频中人脸清晰可见
- 尝试不同的`min_neighbors`值

**3. 输出视频质量差**
- 检查输出编码设置
- 确保输入视频质量足够
- 调整输出比特率参数

### 性能优化建议
- 对于大文件，建议分批次处理
- 调整裁剪参数以获得最佳性能
- 关闭其他占用资源的应用程序

## 🤝 社区支持

### 获取帮助
- **用户群**：1076150045（QQ群）
- **问题反馈**：GitHub Issues页面
- **功能建议**：欢迎提交功能需求

### 贡献指南
欢迎提交代码改进和功能建议！
- 代码规范：遵循PEP8标准
- 测试要求：新增功能需包含测试用例
- 文档更新：同步更新相关文档

## 📄 许可证

本项目采用MIT许可证，允许商业使用和修改。


**💡 提示**：工具持续优化中，建议关注项目更新以获取最新功能和性能提升！